<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filler Game - Single Player</title>
    <style>
        body {
            text-align: center;
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
        }

        #gameCanvas {
            display: block;
            margin: 20px auto;
            background-color: #ffffff;
            border: 2px solid black;
        }

        #buttons {
            margin: 20px;
        }

        .color-button {
            display: inline-block;
            width: 40px;
            height: 40px;
            margin: 5px;
            cursor: pointer;
            border: 1px solid black;
        }

        #score {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="buttons">
        <div class="color-button" id="red" style="background-color: red;"></div>
        <div class="color-button" id="yellow" style="background-color: yellow;"></div>
        <div class="color-button" id="green" style="background-color: green;"></div>
        <div class="color-button" id="blue" style="background-color: blue;"></div>
        <div class="color-button" id="black" style="background-color: black;"></div>
        <div class="color-button" id="pink" style="background-color: pink;"></div>
        <div class="color-button" id="brown" style="background-color: brown;"></div>
    </div>

    <div id="score">Züge: 0/10</div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 300;
        canvas.height = 300;

        const tileSize = 15; // Kleine Kacheln
        const cols = canvas.width / tileSize;
        const rows = canvas.height / tileSize;

        const colors = ['red', 'yellow', 'green', 'blue', 'black', 'pink', 'brown'];
        let grid = [];
        let playerTiles = [[Math.floor(rows / 2), Math.floor(cols / 2)]]; // Spieler beginnt in der Mitte
        let moves = 0;
        const maxMoves = 10;

        // Initialisiere das Spielfeld mit zufälligen Farben
        function initGrid() {
            grid = [];
            for (let row = 0; row < rows; row++) {
                grid[row] = [];
                for (let col = 0; col < cols; col++) {
                    grid[row][col] = colors[Math.floor(Math.random() * colors.length)];
                }
            }
            grid[Math.floor(rows / 2)][Math.floor(cols / 2)] = 'white'; // Startfeld des Spielers
        }

        // Spielfeld rendern
        function renderGrid() {
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    ctx.fillStyle = grid[row][col];
                    ctx.fillRect(col * tileSize, row * tileSize, tileSize, tileSize);
                    ctx.strokeStyle = 'black';
                    ctx.strokeRect(col * tileSize, row * tileSize, tileSize, tileSize);
                }
            }
        }

        // Rekursive Funktion zum Färben der angrenzenden Kacheln
        function floodFill(startRow, startCol, targetColor, newColor) {
            if (startRow < 0 || startRow >= rows || startCol < 0 || startCol >= cols) return; // Grenzen prüfen
            if (grid[startRow][startCol] !== targetColor) return; // Falsche Farbe, also abbrechen
            if (grid[startRow][startCol] === newColor) return; // Bereits gefärbt

            grid[startRow][startCol] = newColor; // Farbe ändern
            playerTiles.push([startRow, startCol]); // Spieler "beansprucht" diese Kachel

            // In alle Richtungen ausbreiten
            floodFill(startRow + 1, startCol, targetColor, newColor);
            floodFill(startRow - 1, startCol, targetColor, newColor);
            floodFill(startRow, startCol + 1, targetColor, newColor);
            floodFill(startRow, startCol - 1, targetColor, newColor);
        }

        // Wenn eine Farbe gewählt wird, führe den Zug aus
        function makeMove(color) {
            if (moves >= maxMoves) return; // Keine Züge mehr erlaubt

            const [centerRow, centerCol] = playerTiles[0]; // Start bei der ersten Spieler-Kachel
            const targetColor = grid[centerRow][centerCol]; // Die aktuelle Farbe des Blocks
            floodFill(centerRow, centerCol, targetColor, color); // Neue Farbe anwenden

            moves++; // Zugzähler erhöhen
            document.getElementById('score').innerText = `Züge: ${moves}/${maxMoves}`;
            
            renderGrid(); // Spielfeld neu zeichnen

            if (moves === maxMoves) {
                calculateScore(); // Punkte berechnen nach 10 Zügen
            }
        }

        // Berechnet die Punktzahl des Spielers
        function calculateScore() {
            let score = playerTiles.length; // Anzahl der vom Spieler "besetzten" Felder
            alert(`Spiel beendet! Du hast ${score} Felder gefüllt.`);
            resetGame(); // Spiel zurücksetzen
        }

        // Setzt das Spiel zurück
        function resetGame() {
            moves = 0;
            playerTiles = [[Math.floor(rows / 2), Math.floor(cols / 2)]];
            initGrid();
            renderGrid();
            document.getElementById('score').innerText = `Züge: ${moves}/${maxMoves}`;
        }

        // Buttons für die Farbwahl
        function setupEventListeners() {
            document.getElementById('red').addEventListener('click', () => makeMove('red'));
            document.getElementById('yellow').addEventListener('click', () => makeMove('yellow'));
            document.getElementById('green').addEventListener('click', () => makeMove('green'));
            document.getElementById('blue').addEventListener('click', () => makeMove('blue'));
            document.getElementById('black').addEventListener('click', () => makeMove('black'));
            document.getElementById('pink').addEventListener('click', () => makeMove('pink'));
            document.getElementById('brown').addEventListener('click', () => makeMove('brown'));
        }

        // Spiel initialisieren
        initGrid();
        renderGrid();
        setupEventListeners();
    </script>
</body>
</html>
